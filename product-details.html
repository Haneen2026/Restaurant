<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Delicious Bites Restaurant</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Product Details Specific Styles */
        .product-details-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 20px;
            min-height: calc(100vh - 200px);
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
        }

        .product-detail-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .product-image-section {
            position: relative;
        }

        .product-detail-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .product-detail-image:hover {
            transform: scale(1.02);
        }

        .product-badges {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .badge {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .badge.vegetarian {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .badge.popular {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
        }

        .product-info-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .product-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text-color);
            margin: 0;
            line-height: 1.2;
        }

        .product-rating-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stars {
            display: flex;
            gap: 0.2rem;
        }

        .star {
            color: #ffd700;
            font-size: 1.2rem;
        }

        .rating-text {
            font-weight: 600;
            color: var(--text-color);
        }

        .product-price-detail {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 0;
        }

        .product-description-detail {
            color: var(--text-light);
            line-height: 1.6;
            font-size: 1.1rem;
            margin: 0;
        }

        .product-ingredients {
            background: rgba(255, 107, 53, 0.08);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
        }

        .ingredients-title {
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .ingredients-list {
            color: var(--text-light);
            line-height: 1.5;
        }

        .quantity-section {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            background: var(--light-color);
            border-radius: 25px;
            overflow: hidden;
            border: 2px solid var(--light-color);
        }

        .quantity-btn {
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--text-color);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .quantity-display {
            min-width: 50px;
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .add-to-cart-section {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .add-to-cart-btn-detail {
            flex: 1;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .add-to-cart-btn-detail:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(255, 107, 53, 0.4);
        }

        .add-to-cart-btn-detail:active {
            transform: translateY(0);
        }

        .related-products-section {
            margin-top: 4rem;
        }

        .related-products-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 2rem;
            text-align: center;
        }

        .related-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }

        .loading-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
        }

        .error-state {
            text-align: center;
            padding: 3rem;
            color: var(--error);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .product-details-container {
                padding: 1rem 15px;
            }

            .product-detail-main {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .product-title {
                font-size: 2rem;
            }

            .product-price-detail {
                font-size: 1.5rem;
            }

            .product-detail-image {
                height: 300px;
            }

            .add-to-cart-section {
                flex-direction: column;
            }

            .add-to-cart-btn-detail {
                width: 100%;
            }

            .quantity-section {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .product-title {
                font-size: 1.5rem;
            }

            .product-detail-image {
                height: 250px;
            }

            .product-price-detail {
                font-size: 1.3rem;
            }

            .related-products-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        /* Dark Mode Support */
        body.dark-mode .product-ingredients {
            background: rgba(255, 107, 53, 0.15);
        }

        body.dark-mode .quantity-selector {
            background: var(--light-color);
            border-color: var(--light-color);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-utensils"></i>
                    <span>Delicious Bites</span>
                </div>
                
                <nav class="nav" id="mainNav">
                    <ul class="nav-list">
                        <li><a href="index.html#home" class="nav-link" aria-label="Home page" tabindex="0">Home</a></li>
                        <li><a href="index.html#menu" class="nav-link active" aria-label="Menu page" tabindex="0">Menu</a></li>
                        <li><a href="index.html#about" class="nav-link" aria-label="About page" tabindex="0">About</a></li>
                        <li><a href="index.html#contact" class="nav-link" aria-label="Contact page" tabindex="0">Contact</a></li>
                    </ul>
                </nav>
                
                <div class="header-actions">
                    <button class="dark-mode-toggle" id="darkModeToggle" aria-label="Toggle dark mode" tabindex="0">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="cart-btn" id="cartBtn" aria-label="Shopping cart" tabindex="0">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount" aria-label="Cart item count">0</span>
                    </button>
                    <button class="order-now-btn" id="orderNowBtn" aria-label="Order now" tabindex="0">Order Now</button>
                </div>
                
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle mobile menu" tabindex="0" aria-expanded="false" aria-controls="mainNav">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Cart Dropdown -->
    <div class="cart-dropdown" id="cartDropdown">
        <div class="cart-header">
            <h3>Your Cart</h3>
            <button class="close-cart" id="closeCart">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <p class="empty-cart">Your cart is empty</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total: <span id="cartTotal">$0.00</span></span>
            </div>
            <button class="checkout-btn" id="checkoutBtn">Checkout</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main">
        <div class="product-details-container">
            <!-- Loading State -->
            <div id="loadingState" class="loading-state">
                <i class="fas fa-spinner fa-spin fa-2x"></i>
                <p>Loading product details...</p>
            </div>

            <!-- Error State -->
            <div id="errorState" class="error-state" style="display: none;">
                <i class="fas fa-exclamation-triangle fa-2x"></i>
                <p>Product not found</p>
                <a href="index.html#menu" class="back-button">Back to Menu</a>
            </div>

            <!-- Product Details Content -->
            <div id="productContent" style="display: none;">
                <a href="index.html#menu" class="back-button">
                    <i class="fas fa-arrow-left"></i>
                    Back to Menu
                </a>

                <div class="product-detail-main">
                    <div class="product-image-section">
                        <img id="productImage" src="" alt="" class="product-detail-image">
                        <div class="product-badges" id="productBadges">
                            <!-- Badges will be loaded here -->
                        </div>
                    </div>

                    <div class="product-info-section">
                        <h1 id="productTitle" class="product-title"></h1>
                        
                        <div class="product-rating-section">
                            <div class="stars" id="productStars"></div>
                            <span class="rating-text" id="productRating"></span>
                        </div>

                        <div class="product-price-detail" id="productPrice"></div>

                        <p class="product-description-detail" id="productDescription"></p>

                        <div class="product-ingredients">
                            <div class="ingredients-title">Ingredients</div>
                            <div class="ingredients-list" id="productIngredients"></div>
                        </div>

                        <div class="quantity-section">
                            <label style="font-weight: 600; color: var(--text-color);">Quantity:</label>
                            <div class="quantity-selector">
                                <button class="quantity-btn" onclick="updateQuantity(-1)">-</button>
                                <span class="quantity-display" id="quantityDisplay">1</span>
                                <button class="quantity-btn" onclick="updateQuantity(1)">+</button>
                            </div>
                        </div>

                        <div class="add-to-cart-section">
                            <button class="add-to-cart-btn-detail" id="addToCartBtn" onclick="addToCart()">
                                <i class="fas fa-shopping-cart"></i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Related Products -->
                <div class="related-products-section">
                    <h2 class="related-products-title">You Might Also Like</h2>
                    <div class="related-products-grid" id="relatedProductsGrid">
                        <!-- Related products will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><i class="fas fa-utensils"></i> Delicious Bites</h3>
                    <p>Experience the finest dining with our carefully crafted menu made from the freshest ingredients.</p>
                    <div class="social-links">
                        <a href="https://facebook.com/deliciousbites" target="_blank"><i class="fab fa-facebook"></i></a>
                        <a href="https://instagram.com/deliciousbites" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="https://twitter.com/deliciousbites" target="_blank"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3><i class="fas fa-info-circle"></i> Policies</h3>
                    <ul>
                        <li><a href="#" onclick="showPolicy('privacy'); return false;">Privacy Policy</a></li>
                        <li><a href="#" onclick="showPolicy('terms'); return false;">Terms of Service</a></li>
                        <li><a href="#" onclick="showPolicy('refund'); return false;">Refund Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3><i class="fas fa-phone-alt"></i> Contact & Support</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +962 7 880 26543</li>
                        <li><i class="fas fa-envelope"></i> info@deliciousbites.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Amman, Jordan</li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3><i class="fas fa-clock"></i> Working Hours</h3>
                    <ul>
                        <li>Mon-Thu: 11:00 AM - 10:00 PM</li>
                        <li>Fri-Sat: 11:00 AM - 11:00 PM</li>
                        <li>Sunday: 12:00 PM - 9:00 PM</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 Delicious Bites Restaurant. All rights reserved. | Made with <i class="fas fa-heart" style="color: #e74c3c;"></i> in Amman, Jordan</p>
            </div>
        </footer>
    </footer>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Scripts -->
    <script src="content.js"></script>
    <script src="large_menu_data.js"></script>
    <script>
        // Product Details Page JavaScript
        let currentProduct = null;
        let currentQuantity = 1;
        let cart = [];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadCartFromStorage();
            setupEventListeners();
            loadProductFromURL();
            setupDarkMode();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Cart functionality
            document.getElementById('cartBtn').addEventListener('click', toggleCartDropdown);
            document.getElementById('closeCart').addEventListener('click', closeCartDropdown);
            document.getElementById('checkoutBtn').addEventListener('click', goToCheckout);
            
            // Close cart dropdown when clicking outside
            document.addEventListener('click', function(e) {
                const cartDropdown = document.getElementById('cartDropdown');
                const cartBtn = document.getElementById('cartBtn');
                
                if (!cartDropdown.contains(e.target) && e.target !== cartBtn) {
                    closeCartDropdown();
                }
            });

            // Mobile menu toggle
            document.getElementById('mobileMenuToggle').addEventListener('click', function() {
                document.querySelector('.nav-list').classList.toggle('active');
            });

            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);

            // Order now button
            document.getElementById('orderNowBtn').addEventListener('click', function() {
                window.location.href = 'index.html#menu';
            });
        }

        // Load product from URL query string
        function loadProductFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            
            if (!productId) {
                showError();
                return;
            }

            // Try to find product in restaurantData first
            let product = null;
            
            // Check if restaurantData is available
            if (typeof restaurantData !== 'undefined' && restaurantData.products) {
                product = restaurantData.products.find(p => p.id == productId);
            }
            
            // If not found, check largeRestaurantMenu
            if (!product && typeof largeRestaurantMenu !== 'undefined' && largeRestaurantMenu.products) {
                product = largeRestaurantMenu.products.find(p => p.id == productId);
            }

            if (product) {
                displayProduct(product);
            } else {
                showError();
            }
        }

        // Display product details
        function displayProduct(product) {
            currentProduct = product;
            
            // Update page title
            document.title = `${product.name} - Delicious Bites Restaurant`;
            
            // Update product information
            document.getElementById('productImage').src = product.image || product.image_url;
            document.getElementById('productImage').alt = product.name;
            document.getElementById('productTitle').textContent = product.name;
            document.getElementById('productPrice').textContent = formatPrice(product.price);
            document.getElementById('productDescription').textContent = product.description;
            
            // Update rating
            updateRating(product.rating || 4.5);
            
            // Update ingredients
            updateIngredients(product);
            
            // Update badges
            updateBadges(product);
            
            // Load related products
            loadRelatedProducts(product);
            
            // Show content, hide loading
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('productContent').style.display = 'block';
            
            // Reset quantity
            currentQuantity = 1;
            document.getElementById('quantityDisplay').textContent = currentQuantity;
        }

        // Update rating display
        function updateRating(rating) {
            const starsContainer = document.getElementById('productStars');
            const ratingText = document.getElementById('productRating');
            
            starsContainer.innerHTML = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            
            for (let i = 0; i < fullStars; i++) {
                starsContainer.innerHTML += '<i class="fas fa-star star"></i>';
            }
            
            if (hasHalfStar) {
                starsContainer.innerHTML += '<i class="fas fa-star-half-alt star"></i>';
            }
            
            const emptyStars = 5 - Math.ceil(rating);
            for (let i = 0; i < emptyStars; i++) {
                starsContainer.innerHTML += '<i class="far fa-star star"></i>';
            }
            
            ratingText.textContent = `${rating} (${Math.floor(Math.random() * 100) + 50} reviews)`;
        }

        // Update ingredients display
        function updateIngredients(product) {
            const ingredientsContainer = document.getElementById('productIngredients');
            
            if (product.ingredients) {
                ingredientsContainer.textContent = product.ingredients;
            } else {
                // Generate default ingredients based on product name and category
                const defaultIngredients = generateDefaultIngredients(product);
                ingredientsContainer.textContent = defaultIngredients;
            }
        }

        // Generate default ingredients based on product
        function generateDefaultIngredients(product) {
            const baseIngredients = {
                'meat': ['Premium meat', 'Spices', 'Herbs', 'Vegetables', 'Sauce'],
                'chicken': ['Fresh chicken', 'Marinade', 'Spices', 'Herbs', 'Vegetables'],
                'fish': ['Fresh fish', 'Lemon', 'Herbs', 'Olive oil', 'Seasonings'],
                'vegetarian': ['Fresh vegetables', 'Herbs', 'Spices', 'Olive oil', 'Seasonings'],
                'pasta': ['Pasta', 'Tomato sauce', 'Cheese', 'Herbs', 'Olive oil'],
                'dessert': ['Sugar', 'Flour', 'Butter', 'Eggs', 'Flavorings'],
                'beverage': ['Natural ingredients', 'Water', 'Natural sweeteners', 'Flavorings']
            };
            
            const productName = product.name.toLowerCase();
            let ingredients = baseIngredients.vegetarian; // default
            
            if (productName.includes('beef') || productName.includes('steak') || productName.includes('meat')) {
                ingredients = baseIngredients.meat;
            } else if (productName.includes('chicken') || productName.includes('poultry')) {
                ingredients = baseIngredients.chicken;
            } else if (productName.includes('fish') || productName.includes('salmon') || productName.includes('seafood')) {
                ingredients = baseIngredients.fish;
            } else if (productName.includes('pasta') || productName.includes('spaghetti') || productName.includes('lasagna')) {
                ingredients = baseIngredients.pasta;
            } else if (productName.includes('cake') || productName.includes('dessert') || productName.includes('ice cream')) {
                ingredients = baseIngredients.dessert;
            } else if (productName.includes('juice') || productName.includes('coffee') || productName.includes('tea')) {
                ingredients = baseIngredients.beverage;
            }
            
            return ingredients.join(', ');
        }

        // Update product badges
        function updateBadges(product) {
            const badgesContainer = document.getElementById('productBadges');
            badgesContainer.innerHTML = '';
            
            if (product.isVegetarian) {
                badgesContainer.innerHTML += '<span class="badge vegetarian">ü•¨ Vegetarian</span>';
            }
            
            if (product.isPopular) {
                badgesContainer.innerHTML += '<span class="badge popular">‚≠ê Popular</span>';
            }
        }

        // Load related products
        function loadRelatedProducts(currentProduct) {
            const relatedGrid = document.getElementById('relatedProductsGrid');
            let allProducts = [];
            
            // Get all products from available data sources
            if (typeof restaurantData !== 'undefined' && restaurantData.products) {
                allProducts = allProducts.concat(restaurantData.products);
            }
            
            if (typeof largeRestaurantMenu !== 'undefined' && largeRestaurantMenu.products) {
                allProducts = allProducts.concat(largeRestaurantMenu.products);
            }
            
            // Find related products (same category or similar)
            const relatedProducts = allProducts
                .filter(p => p.id !== currentProduct.id && 
                           (p.categoryId === currentProduct.categoryId || 
                            p.name.toLowerCase().includes(currentProduct.name.toLowerCase().split(' ')[0])))
                .slice(0, 4);
            
            if (relatedProducts.length > 0) {
                relatedGrid.innerHTML = relatedProducts.map(product => `
                    <div class="product-card ${product.isPopular ? 'popular' : ''} ${product.isVegetarian ? 'vegetarian' : ''}" 
                         onclick="goToProductDetail(${product.id})">
                        <img src="${product.image || product.image_url}" alt="${product.name}" class="product-image">
                        <div class="product-info">
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${truncateText(product.description, 80)}</p>
                            <div class="product-price">${formatPrice(product.price)}</div>
                            <button class="add-to-cart-btn" onclick="event.stopPropagation(); quickAddToCart(${product.id})">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `).join('');
            } else {
                relatedGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--text-light);">No related products found.</p>';
            }
        }

        // Navigate to product detail page
        function goToProductDetail(productId) {
            window.location.href = `product-details.html?id=${productId}`;
        }

        // Quick add to cart from related products
        function quickAddToCart(productId) {
            let product = null;
            
            if (typeof restaurantData !== 'undefined' && restaurantData.products) {
                product = restaurantData.products.find(p => p.id === productId);
            }
            
            if (!product && typeof largeRestaurantMenu !== 'undefined' && largeRestaurantMenu.products) {
                product = largeRestaurantMenu.products.find(p => p.id === productId);
            }
            
            if (product) {
                addToCartWithProduct(product, 1);
            }
        }

        // Update quantity
        function updateQuantity(change) {
            currentQuantity = Math.max(1, currentQuantity + change);
            document.getElementById('quantityDisplay').textContent = currentQuantity;
        }

        // Add to cart
        function addToCart() {
            if (currentProduct) {
                addToCartWithProduct(currentProduct, currentQuantity);
            }
        }

        // Add product to cart
        function addToCartWithProduct(product, quantity) {
            const existingItem = cart.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    ...product,
                    quantity: quantity
                });
            }
            
            saveCartToStorage();
            updateCartUI();
            showToast(`${product.name} added to cart!`);
        }

        // Cart management functions
        function loadCartFromStorage() {
            const savedCart = localStorage.getItem('restaurantCart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartUI();
            }
        }

        function saveCartToStorage() {
            localStorage.setItem('restaurantCart', JSON.stringify(cart));
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="empty-cart">Your cart is empty</p>';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-quantity">Quantity: ${item.quantity}</div>
                        </div>
                        <div class="cart-item-actions">
                            <span class="cart-item-price">${formatPrice(item.price * item.quantity)}</span>
                            <button class="remove-item-btn" onclick="removeFromCart(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = formatPrice(total);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCartToStorage();
            updateCartUI();
            showToast('Item removed from cart');
        }

        function toggleCartDropdown() {
            document.getElementById('cartDropdown').classList.toggle('active');
        }

        function closeCartDropdown() {
            document.getElementById('cartDropdown').classList.remove('active');
        }

        function goToCheckout() {
            if (cart.length === 0) {
                showToast('Your cart is empty!', 'warning');
                return;
            }
            window.location.href = 'index.html#checkout';
        }

        // Utility functions
        function formatPrice(price) {
            return `$${price.toFixed(2)}`;
        }

        function truncateText(text, maxLength) {
            return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        function showError() {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('errorState').style.display = 'block';
        }

        // Dark mode functions
        function setupDarkMode() {
            const savedDarkMode = localStorage.getItem('darkMode') === 'true';
            if (savedDarkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            
            const darkModeToggle = document.getElementById('darkModeToggle');
            darkModeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        }
    </script>
</body>
</html>
